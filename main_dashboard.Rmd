---
title: "Survey Dashboard"
subtitle: "2024 IOM South Sudan"
author: "Data & Methods Subteam - Bass Connections"
date: "2024-10-08"
output:
 html_document:
   theme: journal
   toc: true
   toc_float: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
library(purrr)
library(janitor)
library(forcats)
library(scales)
library(knitr)
library(kableExtra)
library(sjmisc)
library(likert)
library(writexl)

options(digits=2)
```

```{r data, include=FALSE}

# Setting up directory

# Renan
setwd("G:/.shortcut-targets-by-id/1vb8pjBFn0skX769fagfR8mbbt6mXSnjI/Bass Team South Sudan/Sub-Team Folders/1. Methods & Data/")

# Loading and joining data base  
df <- read.csv("Descriptive Analysis/Bass_Team_Data_V2.csv")

##Faustin : Adding these lines for the code to work on my computer. can be deleted later.
df <- read.csv(file ='/Users/faustinkambale/Library/CloudStorage/OneDrive-DukeUniversity/Duke/Classes/Fall 2024/Bass Connextion/Duke-OIM/bass_southsudan/data/Bass_Team_Data_V2.csv', header=TRUE,skip=0)

```

Total number of respondents: **`r df %>% nrow()`**

All question numbers below are based on the ["Key Variables for Descriptive Statistics"](https://docs.google.com/document/d/1ebEU83f8HC1U-u-Qz2uxLPLWQA_oEzr6n0tZPpUNEgE/edit#heading=h.457qdvvkxtly) doc file.

All the descriptive calculated for index questions were based on the **unimputed** variable.

# 1) Socio-demographics

## Languages {.tabset} 

### Entire sample

```{r Languages, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q0.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q0.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q0.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q0.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q0.2 = factor(Q0.2)) %>%
  ggplot(aes(Q0.2, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q0.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Languages by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q0.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q0.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## County {.tabset} 

### Entire sample

```{r County, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q1.5_County, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q1.5_County, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q1.5_County = factor(Q1.5_County)) %>%
  ggplot(aes(Q1.5_County, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.5)+
  labs(x = "Q1.5_County", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

## Payam {.tabset} 

### Entire sample

```{r Payam, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_Payam) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q1.5_Payam, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_Payam) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q1.5_Payam, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q1.5_Payam = factor(Q1.5_Payam)) %>%
  ggplot(aes(Q1.5_Payam, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q1.5_Payam", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Payam by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q1.5_Payam) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q1.5_Payam, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Sex {.tabset} 

### Entire sample

```{r Sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.1, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.1, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.1 = factor(Q2.1)) %>%
  ggplot(aes(Q2.1, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Sex by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.1, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Age {.tabset} 

### Entire sample

```{r Age, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.2 = factor(Q2.2)) %>%
  ggplot(aes(Q2.2, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Age by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Which of the following information sources do you rely on most? {.tabset} 

### Entire sample

```{r Source of info, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.8, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.8, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.8 = factor(Q2.8)) %>%
  ggplot(aes(Q2.8, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.8", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Source of info by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.8) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.8, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### By sex

How to interpret the table? Example: Within the Male, 42% use Radio as their main source of information. Within Female, its 38%. 
```{r Source of info by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.8) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.8, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Religion {.tabset} 

### Entire sample

```{r Religion, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.10) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.10, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.10) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.10, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.10 = factor(Q2.10)) %>%
  ggplot(aes(Q2.10, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.10", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Religion by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.10) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.10, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Ethnicity {.tabset} 

### Entire sample

```{r Ethnicity, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.11) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.11, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.11) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.11, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.11 = factor(Q2.11)) %>%
  ggplot(aes(Q2.11, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.11", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Ethnicity by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.11) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.11, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

# 2) Mobility & Displacement

### Q2.4 (Mobility): To what degree do you feel that you have the ability to choose the location in which you live? {.tabset}  

#### Entire sample

```{r Q2.4, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.4, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.4, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.4 = factor(Q2.4)) %>%
  ggplot(aes(Q2.4, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.4", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q2.4 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.4) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.4, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

#### By sex

```{r Q2.4 by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.4) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.4, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q2.5 (Moved): Have you ever moved from one county to another? {.tabset} 

#### Entire sample

```{r Q2.5, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.5, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.5, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.5 = factor(Q2.5)) %>%
  ggplot(aes(Q2.5, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.5", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q2.5 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.5) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.5, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

#### By sex

```{r Q2.5 by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.5) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.5, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Q2.5.1 (Reason Moved): If yes to Q2.5, Which of the following most accurately describes why you moved? {.tabset} 

#### Entire sample

```{r Q2.5.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.5.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.5.1, answers) %>%
  drop_na() %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.5.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.5.1, answers) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers),
         Q2.5.1 = factor(Q2.5.1)) %>%
  ggplot(aes(Q2.5.1, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.5.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q2.5.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.5.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.5.1, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

#### By sex

```{r Q2.5.1 by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.5.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.5.1, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Q2.5.2 (Forced displaced then return): If answer “1” to Q2.5.1 (i.e. fled for security/survival), do you currently live in the county in which you were born? {.tabset} 

#### Entire sample

```{r Q2.5.2, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.5.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.5.2, answers) %>%
  drop_na() %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.5.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.5.2, answers) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers),
         Q2.5.2 = factor(Q2.5.2)) %>%
  ggplot(aes(Q2.5.2, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.5.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q2.5.2 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.5.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.5.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

#### By sex

```{r Q2.5.2 by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.5.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.5.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Q2.6 (Intention to move): Do you intend to leave [this village] and live elsewhere in the next 5 years? {.tabset} 

#### Entire sample

```{r Q2.6, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.6, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.6, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.6 = factor(Q2.6)) %>%
  ggplot(aes(Q2.6, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.6", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q2.6 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.6) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.6, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

#### By sex

```{r Q2.6 by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.6) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.6, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Q2.6.1 (Where intend to move): If yes to Q2.6, where do you intend to move? {.tabset}

#### Entire sample

```{r Q2.6.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.6.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.6.1, answers) %>%
  drop_na() %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.6.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.6.1, answers) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers),
         Q2.6.1 = factor(Q2.6.1)) %>%
  ggplot(aes(Q2.6.1, answers)) +
  geom_col(fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.6.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q2.6.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.6.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.6.1, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

#### By sex

```{r Q2.6.1 by sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1, Q2.6.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q2.1)) %>%
  group_by(Q2.1) %>%
  drop_na() %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q2.1, Q2.6.1, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

# 3) Human Fragility

All the answers are on a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

## Index Questions

### Q5.5.1: Over the past year, how often, if ever, have you or anyone in your family gone without enough foor to eat? {.tabset}

#### Entire sample

```{r Q5.5.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q5.5.1_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q5.5.1_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q5.5.1_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q5.5.1_raw = factor(Q5.5.1_raw)) %>%
  ggplot(aes(Q5.5.1_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q5.5.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q5.5.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q5.5.1_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q5.5.1_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q5.5.1_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q5.5.2: Over the past year, how often, if ever, have you or anyone in your family gone without enough clean water for home use? {.tabset} 

#### Entire sample

```{r Q5.5.2, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q5.5.2_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q5.5.2_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q5.5.2_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q5.5.2_raw = factor(Q5.5.2_raw)) %>%
  ggplot(aes(Q5.5.2_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q5.5.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q5.5.2 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q5.5.2_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q5.5.2_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q5.5.2_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q5.5.3: Over the past year, how often, if ever, have you or anyone in your family gone without necessary medicines or medical treatment? {.tabset} 

#### Entire sample

```{r Q5.5.3, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q5.5.3_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q5.5.3_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q5.5.3_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q5.5.3_raw = factor(Q5.5.3_raw)) %>%
  ggplot(aes(Q5.5.3_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q5.5.3", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q5.5.3 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q5.5.3_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q5.5.3_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q5.5.3_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q7.1: What type of shelter are you currently living in? {.tabset} 

#### Entire sample

```{r Q7.1, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q7.1_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q7.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q7.1_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q7.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q7.1_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q7.1_raw = factor(Q7.1_raw)) %>%
  ggplot(aes(Q7.1_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q7.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q7.1 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q7.1_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q7.1_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q7.1_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q8.5.6: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of the sexual violence in your community? {.tabset} 

#### Entire sample

```{r Q8.5.6, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.6_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.6_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.6_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.6_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q8.5.6_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.6_raw = factor(Q8.5.6_raw)) %>%
  ggplot(aes(Q8.5.6_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q8.5.6", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.6_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q8.5.6_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q8.5.6_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Additional Questions

Coming soon...

# 4) Societal Fragility

All the answers are in a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

Ex:
0 = Not severe at all 
0.25 = Not severe
0.50 = Somewhat severe
0.75 = Severe
1 = Extremely severe

## Index Questions

### Q6.1 How much do you feel welcomed or accepted in your current community? {.tabset}

#### Entire sample

```{r Q6.1, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df%>% 
  summarize(mean = mean(Q6.1_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q6.1_raw, answers) %>%
  mutate(percentage = answers/sum(answers) * 100) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q6.1_raw, answers) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q6.1_raw = factor(Q6.1_raw)) %>%
  ggplot(aes(Q6.1_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q6.1_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q6.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q6.1_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q1.5_County, Q6.1_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers) * 100) %>%
  ungroup() %>%
  select(Q1.5_County, Q6.1_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q6.2 In the past year, how often, if at all, have you been personally discriminated against based on any of the following: your gender, your religion, your ethnicity, any disability you might have, or your place of origin? {.tabset}

#### Entire sample

```{r Q6.2, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  summarize(mean = mean(Q6.2_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q6.2_raw, answers) %>%
  mutate(percentage = answers/sum(answers) * 100) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q6.2_raw, answers) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q6.2_raw = factor(Q6.2_raw)) %>%
  ggplot(aes(Q6.2_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q6.2_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q6.2 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q6.2_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q1.5_County, Q6.2_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers) * 100) %>%
  ungroup() %>%
  select(Q1.5_County, Q6.2_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q6.3 To what extent do you agree with the following statement? “People in your boma are willing to help each other.” {.tabset}

#### Entire sample

```{r Q6.3, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  summarize(mean = mean(Q6.3_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q6.3_raw, answers) %>%
  mutate(percentage = answers/sum(answers) * 100) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q6.3_raw, answers) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q6.3_raw = factor(Q6.3_raw)) %>%
  ggplot(aes(Q6.3_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q6.3_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q6.3 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q6.3_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q1.5_County, Q6.3_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers) * 100) %>%
  ungroup() %>%
  select(Q1.5_County, Q6.3_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q6.4 Imagine that you were in an argument with your neighbor about a small issue. To what extent do you agree or disagree with the following statement? “I know who I could seek help from to resolve this argument.” {.tabset}

#### Entire sample

```{r Q6.4, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  summarize(mean = mean(Q6.4_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.4_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q6.4_raw, answers) %>%
  mutate(percentage = answers/sum(answers) * 100) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.4_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q6.4_raw, answers) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q6.4_raw = factor(Q6.4_raw)) %>%
  ggplot(aes(Q6.4_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q6.4_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q6.4 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q6.4_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q1.5_County, Q6.4_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers) * 100) %>%
  ungroup() %>%
  select(Q1.5_County, Q6.4_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q6.9 How would you describe the relationship between individuals who are not originally from the community and the rest of the community members? {.tabset}

#### Entire sample

```{r Q6.9, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  summarize(mean = mean(Q6.9_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.9_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q6.9_raw, answers) %>%
  mutate(percentage = answers/sum(answers) * 100) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q6.9_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q6.9_raw, answers) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q6.9_raw = factor(Q6.9_raw)) %>%
  ggplot(aes(Q6.9_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q6.9_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q6.9 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df%>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q6.9_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df%>%
  group_by(Q1.5_County, Q6.9_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers) * 100) %>%
  ungroup() %>%
  select(Q1.5_County, Q6.9_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Additional Questions

Coming soon...

# 5) Security Fragility

All the answers are in a *scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

## Index Questions

### Q8.5.2: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of violent crime in your community {.tabset} 

#### Entire sample

```{r Q8.5.2, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.2_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.2_raw) %>%
  summarise(answers = n()) %>%
  #arrange(desc(answers)) %>%
  select(Q8.5.2_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.2_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.2_raw = factor(Q8.5.2_raw)) %>%
  ggplot(aes(Q8.5.2_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q8.5.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5.2 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.2_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County","Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by( Q1.5_County, Q8.5.2_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  select(Q1.5_County, Q8.5.2_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q8.5.3: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of armed conflict/war happening in your community? {.tabset} 

#### Entire sample

```{r Q8.5.3, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.2_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.3_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q8.5.3_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.3_raw = factor(Q8.5.3_raw)) %>%
  ggplot(aes(Q8.5.3_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q8.5.3", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5.3 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.3_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County","Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by( Q1.5_County, Q8.5.3_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  select(Q1.5_County, Q8.5.3_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```
### Q8.5.3: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of land conflicts happening in your community? {.tabset} 

#### Entire sample
```{r Q8.5.7, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.7_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.7_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.7_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.7_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q8.5.7_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.7_raw = factor(Q8.5.7_raw)) %>%
  ggplot(aes(Q8.5.7_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q8.5.7", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5.7 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.7_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County","Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by( Q1.5_County, Q8.5.7_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  select(Q1.5_County, Q8.5.7_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)
```

### Q8.5.8: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of conflicts over cattle happening in your community? {.tabset} 

#### Entire sample
```{r Q8.5.8, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.8_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.8_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.8_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.8_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q8.5.8_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.8_raw = factor(Q8.5.8_raw)) %>%
  ggplot(aes(Q8.5.8_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q8.5.8", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5.8 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.8_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County","Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by( Q1.5_County, Q8.5.8_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  select(Q1.5_County, Q8.5.8_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)
```

### Q8.5.9: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of violence involving community-based militias, vigilante groups, or self-defense groups happening in your community? {.tabset}

#### Entire sample
```{r Q8.5.9, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.9_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.9_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.9_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.9_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q8.5.9_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.9_raw = factor(Q8.5.9_raw)) %>%
  ggplot(aes(Q8.5.9_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q8.5.9", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5.9 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.9_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County","Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by( Q1.5_County, Q8.5.9_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  select(Q1.5_County, Q8.5.9_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)
```

# 6) Political and Legal Fragility 

All the answers are in a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

## Index Questions

### Q10.1.2: How much confidence do you have in your state government? {.tabset}

0 (none) to 1 (a lot)

#### Entire sample

```{r Q10.1.2_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.1.2_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.2_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.1.2_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.2_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.1.2_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.1.2_raw = factor(Q10.1.2_raw)) |>
  ggplot(aes(Q10.1.2_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
   geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.1.2: Trust in State Governments", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()

```

#### By county

```{r Q10.1.2_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.1.2_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.1.2_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.1.2_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.1.10: How much confidence do you have in informal authorities, such as councils of elders? {.tabset}

0 (none) to 1 (a lot)

#### Entire sample

```{r Q10.1.10_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.1.10_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.1.10_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.1.10_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.1.10_raw = factor(Q10.1.10_raw)) |>
  ggplot(aes(Q10.1.10_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.1.10: Trust in Informal Authorities", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()
```

#### By county

```{r Q10.1.10_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.1.10_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.1.10_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.1.10_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.10: South Sudan’s next national elections are scheduled for December 2024 after being postponed several times. How safe or unsafe would you feel going to a polling station to cast your vote? {.tabset}

0 (very unsafe) to 1 (very safe)

#### Entire sample

```{r Q10.10_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.10_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.10_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.10_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.10_raw = factor(Q10.10_raw)) |>
  ggplot(aes(Q10.10_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.10: Participation in Democracy Without Fear", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()

```

#### By county

```{r Q10.10_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.10_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.10_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.10_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.12: At present, how safe do you feel speaking publicly on politically sensitive issues? {.tabset}

0(very unsafe) to 1(very safe)

#### Entire sample

```{r Q10.12_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.12_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.12_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.12_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.12_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.12_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.12_raw = factor(Q10.12_raw)) |>
  ggplot(aes(Q10.12_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.12: Freedom of Speech", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()
```

#### By county

```{r Q10.12_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.12_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.12_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.12_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.13: Which of the following statements best describes the role that politicians in Juba play in your community? {.tabset}

0(they make the community much less safe) to 1(they make the community much more safe)

#### Entire sample

```{r Q10.13_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.13_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.13_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.13_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.13_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.13_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.13_raw = factor(Q10.13_raw)) |>
  ggplot(aes(Q10.13_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.13: Trust in National Government", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()
```

#### By county

```{r Q10.13_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.13_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.13_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.13_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Additional Questions

Coming soon...

# 7) Environmental Fragility

All the answers are in a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

Ex:
0 = Not severe at all 
0.25 = Not severe
0.50 = Somewhat severe
0.75 = Severe
1 = Extremely severe

## Index Questions

### Q11.10A Many people in South Sudan have experienced the following: too much rain, too little rain, temperatures that are too high, temperatures that are too low, pests and crop diseases, and deforestation and erosion. How severe would you say the impact of any of these experiences have been on your household income, on a scale from 1 to 5 where 1 means “not severe at all and 5 means “extremely severe?” {.tabset}

#### Entire sample

```{r Q11.10A, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10A_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10A_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10A_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10A_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10A_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10A_raw = factor(Q11.10A_raw)) %>%
  ggplot(aes(Q11.10A_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10A_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10A by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10A_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10A_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10A_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.10B And how severe would you say the impact of any of these experiences have been on your household food consumption?

#### Entire sample

```{r Q11.10B, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10B_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10B_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10B_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10B_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10B_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10B_raw = factor(Q11.10B_raw)) %>%
  ggplot(aes(Q11.10B_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10B_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10B by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10B_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10B_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10B_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.10C And how severe would you say the impact of any of these experiences have been on your household’s ability to choose where you live?

#### Entire sample

```{r Q11.10C, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10C_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10C_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10C_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10C_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10C_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10C_raw = factor(Q11.10C_raw)) %>%
  ggplot(aes(Q11.10C_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10C_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10C by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10C_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10C_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10C_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.10D And how severe would you say the impact of any of these experiences have been on your household’s health?

```{r Q11.10D, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10D_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10D_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10D_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10D_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10D_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10D_raw = factor(Q11.10D_raw)) %>%
  ggplot(aes(Q11.10D_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10D_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10D by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10D_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10D_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10D_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.11 Imagine that there was a flood coming to your town tomorrow. If you knew about this incoming flood before the water arrived, to what extent do you agree with the following statement: “I would be able to use this information to protect my household?”

```{r Q11.11, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.11_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.11_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.11_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.11_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.11_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.11_raw = factor(Q11.11_raw)) %>%
  ggplot(aes(Q11.11_raw, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.11_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```
#### By county

```{r Q11.11 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.11_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.11_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.11_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```
# Additinal questions on Environmental fragility 

##Q11.2 Are the water sources accessible to all households in the community?
  Yes = 1, No = 0

```{r}
df %>% 
  mutate(Q11.2 = ifelse((str_trim(Q11.2)) == "Yes", 1, 0))%>% # Convert to 1 and 0
  summarize(mean = mean(Q11.2, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)
 

df %>%
  group_by(Q11.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.2 = factor(Q11.2)) %>%
  ggplot(aes(Q11.2, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 13),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```
#### By county

```{r Q11.2 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  mutate(Q11.2 = ifelse((str_trim(Q11.2)) == "Yes", 1, 0))%>%
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.2, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

##Q11.3 What is the main reason water isn’t accessible to all households?
1.Distance, 2.Insecurity, 3.Quality of water, 4.Not enough water, 5. Non-functioning infrastructure, 6. Other: (please specify), -2. Prefer not to answer

```{r}
df %>%
  group_by(Q11.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.3, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.3, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.3 = factor(Q11.3)) %>%
  ggplot(aes(Q11.3, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Reason for Water Absence", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 13),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

#or a Pie chat 

df %>%
  group_by(Q11.3) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100,
         label = paste0(round(percentage, 1), "%")) %>%
  ggplot(aes(x = "", y = percentage, fill = Q11.3)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  geom_text(aes(label = label), color = "white", 
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Reasons for Lack of Water Access") +
  theme_void() +
  theme(legend.title = element_blank())

```
#### By county

```{r Q11.3 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}
df %>%
  group_by(Q1.5_County, Q11.3) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.3, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.4 Is the water most people in your community drink safe for human consumption?
Yes = 1, No = 0,  -2. Prefer not to answer
```{r}
df %>% 
  mutate(Q11.4 = ifelse((str_trim(Q11.4)) == "Yes", 1, 0))%>% # Convert to 1 and 0
  summarize(mean = mean(Q11.4, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)
 
df %>%
  group_by(Q11.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.4, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.4, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.4 = factor(Q11.4)) %>%
  ggplot(aes(Q11.4, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.4", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 13),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

#or a Pie chat 

df %>%
  group_by(Q11.4) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100,
         label = paste0(round(percentage, 1), "%")) %>%
  ggplot(aes(x = "", y = percentage, fill = Q11.4)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  geom_text(aes(label = label), color = "white", 
            position = position_stack(vjust = 0.5), size = 9) +
  labs(title = "Reasons for Lack of Water Access") +
  theme_void() +
  theme(legend.title = element_blank())
```
#### By county

```{r Q11.4 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  mutate(Q11.4 = ifelse((str_trim(Q11.4)) == "Yes", 1, 0))%>%
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.4, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.4) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.4, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.5 Who in your household is responsible for collecting water? Select all that apply.
1. Male child, 2.Female child, 3. Adult woman, 4.Adult man,  -2. Prefer not to answer 

```{r}
#Clustering reponse by category 
df %>%
  group_by(Q11.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.5, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lcc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

# The multi-response matrix
df_matrix <- df %>%
  mutate(Male_Child = ifelse(grepl("Male child", Q11.5), 1, 0),
         Female_Child = ifelse(grepl("Female child", Q11.5), 1, 0),
         Adult_Woman = ifelse(grepl("Adult woman", Q11.5), 1, 0),
         Adult_Man = ifelse(grepl("Adult man", Q11.5), 1, 0)) %>%
  summarise(across(starts_with("Male_Child"):starts_with("Adult_Man"), sum)) %>%
  pivot_longer(cols = everything(), names_to = "Household_Member", values_to = "Count")

# Plot a stacked bar chart
ggplot(df_matrix, aes(x = "", y = Count, fill = Household_Member)) +
  geom_bar(stat = "identity") +
  coord_polar("y") +
  labs(title = "Distribution of Water Collection Responsibilities by Household Member",
       x = NULL, y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_blank(), legend.title = element_blank())

# Plot flipped bar chart
ggplot(df_matrix, aes(x = reorder(Household_Member, -Count), y = Count, fill = Household_Member)) +
  geom_bar(stat = "identity") +
  labs(x = "Household Member Responsible for Water Collection", 
       y = "Count of Responses",
       title = "Responsibility for Water Collection by Household Member") +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = FALSE)
```
### by county

```{r}
#Descriptive table 
df %>%
  group_by(Q1.5_County, Q11.5) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.5, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)

#Short Matrix-Table 
df %>%
  mutate(Male_Child = ifelse(grepl("Male child", Q11.5), 1, 0),
         Female_Child = ifelse(grepl("Female child", Q11.5), 1, 0),
         Adult_Woman = ifelse(grepl("Adult woman", Q11.5), 1, 0),
         Adult_Man = ifelse(grepl("Adult man", Q11.5), 1, 0)) %>%
  group_by(Q1.5_County) %>%
  summarise(across(starts_with("Male_Child"):starts_with("Adult_Man"), sum, .names = "Count_{.col}")) %>%
  kable(align = "l", 
        col.names = c("County", "Male Child", "Female Child", "Adult Woman", "Adult Man")) %>%
  kable_styling(position = "left", full_width = F)

# Bar chart by county 

df_matrix_county <- df %>%
  mutate(Male_Child = ifelse(grepl("Male child", Q11.5), 1, 0),
         Female_Child = ifelse(grepl("Female child", Q11.5), 1, 0),
         Adult_Woman = ifelse(grepl("Adult woman", Q11.5), 1, 0),
         Adult_Man = ifelse(grepl("Adult man", Q11.5), 1, 0)) %>%
  group_by(Q1.5_County) %>%
  summarise(across(starts_with("Male_Child"):starts_with("Adult_Man"), sum)) %>%
  pivot_longer(cols = -Q1.5_County, names_to = "Household_Member", values_to = "Count")
ggplot(df_matrix_county, aes(x = reorder(Household_Member, Count), y = Count, fill = Household_Member)) +
  geom_bar(stat = "identity") +
  labs(x = "Household Member Responsible for Water Collection", 
       y = "Count of Responses",
       title = "Responsibility for Water Collection by Household Member and County") +
  theme_minimal() +
  coord_flip() +  # Flip for horizontal bars
  theme(axis.text.y = element_text(hjust = 1)) +
  guides(fill = FALSE) +
  facet_wrap(~ Q1.5_County, scales = "free_y")
```

## Q11.7 On a scale from 1 through 5, where 1 is “strongly disagree” and 5 is “strongly agree,” how much do you agree with the following statements about your county’s experiences within the last 5 years?

All the answers are in a **scale of 1-5**, i.e. can have the following values: 1, 2, 3, 4, 5. The higher, the more agreement

Ex:
1 = Strongly disagree
2 = Disagree
3 = Neither agree nor disagree
4 = Agree
5 = Strongly agree
6 = Prefer not to respond

## Q11.7.1 In the last 5 years, the timing of the seasonal rains has changed

#### Entire sample

```{r Q11.7.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.1, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.1, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.1 = factor(Q11.7.1)) %>%
  ggplot(aes(Q11.7.1, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10A_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

# For a Pie chart

df %>%
  group_by(Q11.7.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.2 = factor(Q11.7.1)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.1)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.1") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.1 to numeric
df %>%
  mutate(Q11.7.1 = case_when(
    Q11.7.1 == "Strongly disagree" ~ 1,
    Q11.7.1 == "Disagree" ~ 2,
    Q11.7.1 == "Neither agree nor disagree" ~ 3,
    Q11.7.1 == "Agree" ~ 4,
    Q11.7.1 == "Strongly agree" ~ 5,
    Q11.7.1 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.1, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.1, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.7.2 In the last 5 years, water shortages in the dry season have become more frequent

#### Entire sample

```{r Q11.7.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.2 = factor(Q11.7.2)) %>%
  ggplot(aes(Q11.7.2, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.2 = factor(Q11.7.2)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.2)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.2 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.1 to numeric
df %>%
  mutate(Q11.7.2 = case_when(
    Q11.7.2 == "Strongly disagree" ~ 1,
    Q11.7.2 == "Disagree" ~ 2,
    Q11.7.2 == "Neither agree nor disagree" ~ 3,
    Q11.7.2 == "Agree" ~ 4,
    Q11.7.2 == "Strongly agree" ~ 5,
    Q11.7.2 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.2, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.2, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.7.3 In the last 5 years, the diversity of wildlife has diminished

#### Entire sample

```{r Q11.7.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.3, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.3, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.3 = factor(Q11.7.3)) %>%
  ggplot(aes(Q11.7.3, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.3", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.3 = factor(Q11.7.3)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.3)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.3 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.3 to numeric
df %>%
  mutate(Q11.7.3 = case_when(
    Q11.7.3 == "Strongly disagree" ~ 1,
    Q11.7.3 == "Disagree" ~ 2,
    Q11.7.3 == "Neither agree nor disagree" ~ 3,
    Q11.7.3 == "Agree" ~ 4,
    Q11.7.3 == "Strongly agree" ~ 5,
    Q11.7.3 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.3, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.3) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.3, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

##Q11.7.4 In the last 5 years, there has been an increase in urbanization, for example the construction of new buildings

#### Entire sample

```{r Q11.7.4, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.4, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.4, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.4 = factor(Q11.7.4)) %>%
  ggplot(aes(Q11.7.4, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.4", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.4 = factor(Q11.7.4)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.4)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.4 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.4 to numeric
df %>%
  mutate(Q11.7.4 = case_when(
    Q11.7.4 == "Strongly disagree" ~ 1,
    Q11.7.4 == "Disagree" ~ 2,
    Q11.7.4 == "Neither agree nor disagree" ~ 3,
    Q11.7.4 == "Agree" ~ 4,
    Q11.7.4 == "Strongly agree" ~ 5,
    Q11.7.4 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.4, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.4) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.4, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

##Q11.7.5 In the last 5 years, the land has become less fertile, such as from soil erosion

#### Entire sample

```{r Q11.7.5, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.5, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.5, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.5 = factor(Q11.7.5)) %>%
  ggplot(aes(Q11.7.5, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.5", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.5 = factor(Q11.7.5)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.5)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.5 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.5 to numeric
df %>%
  mutate(Q11.7.5 = case_when(
    Q11.7.5 == "Strongly disagree" ~ 1,
    Q11.7.5 == "Disagree" ~ 2,
    Q11.7.5 == "Neither agree nor disagree" ~ 3,
    Q11.7.5 == "Agree" ~ 4,
    Q11.7.5 == "Strongly agree" ~ 5,
    Q11.7.5 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.5, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.5) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.5, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.7.6 In the last 5 years, deforestation has occurred, meaning that there has been cutting or other reductions in the size of forests

#### Entire sample

```{r Q11.7.6, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.6, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.6, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.6 = factor(Q11.7.6)) %>%
  ggplot(aes(Q11.7.6, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.6", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.6 = factor(Q11.7.6)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.6)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.6 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.6 to numeric
df %>%
  mutate(Q11.7.6 = case_when(
    Q11.7.6 == "Strongly disagree" ~ 1,
    Q11.7.6 == "Disagree" ~ 2,
    Q11.7.6 == "Neither agree nor disagree" ~ 3,
    Q11.7.6 == "Agree" ~ 4,
    Q11.7.6 == "Strongly agree" ~ 5,
    Q11.7.6 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.6, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.6) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.6, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

### Q11.7.7 In the last 5 years, excessive grazing has caused damage to grassland.

#### Entire sample
```{r Q11.7.7, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.7) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.7, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.7) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.7, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.7 = factor(Q11.7.7)) %>%
  ggplot(aes(Q11.7.7, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.7", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.7) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.7 = factor(Q11.7.7)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.7)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.7 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.7 to numeric
df %>%
  mutate(Q11.7.7 = case_when(
    Q11.7.7 == "Strongly disagree" ~ 1,
    Q11.7.7 == "Disagree" ~ 2,
    Q11.7.7 == "Neither agree nor disagree" ~ 3,
    Q11.7.7 == "Agree" ~ 4,
    Q11.7.7 == "Strongly agree" ~ 5,
    Q11.7.7 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.7, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.7) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.7, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

### Q11.7.8 In the last 5 years, the amount of waste left in the streets has increased.

#### Entire sample
```{r Q11.7.8, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.7.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.7.8, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.7.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.7.8, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.7.8 = factor(Q11.7.8)) %>%
  ggplot(aes(Q11.7.8, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.7.8", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.7.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.7.8 = factor(Q11.7.8)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.7.8)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.7.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.7.8 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.7.8 to numeric
df %>%
  mutate(Q11.7.8 = case_when(
    Q11.7.8 == "Strongly disagree" ~ 1,
    Q11.7.8 == "Disagree" ~ 2,
    Q11.7.8 == "Neither agree nor disagree" ~ 3,
    Q11.7.8 == "Agree" ~ 4,
    Q11.7.8 == "Strongly agree" ~ 5,
    Q11.7.8 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.7.8, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.7.8) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.7.8, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8 Over the next 5 years in South Sudan, do you think changes in climate or weather patterns will cause less/fewer of the following crises, more of the following crises, or will have no impact on the following crises? 

All the answers are in a **scale of 1-3**, i.e. can have the following values: 1, 2, 3.

Ex:
1 = Less impact
2 = More impact
3 = No impact

## Q11.8.1 Droughts and water shortages

#### Entire sample

```{r Q11.8.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.1, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.1, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.1 = factor(Q11.8.1)) %>%
  ggplot(aes(Q11.8.1, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.1 = factor(Q11.8.1)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.1)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.1") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.1 to numeric
df %>%
  mutate(Q11.8.1 = case_when(
    Q11.8.1 == "Less" ~ 1,
    Q11.8.1 == "More" ~ 2,
    Q11.8.1 == "No impact" ~ 3,
    Q11.8.1 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.1, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.1, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8.2 Floods

#### Entire sample

```{r Q11.8.2, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.2 = factor(Q11.8.2)) %>%
  ggplot(aes(Q11.8.2, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.2 = factor(Q11.8.2)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.2)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.2") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.2 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.2 to numeric
df %>%
  mutate(Q11.8.2 = case_when(
    Q11.8.2 == "Less" ~ 1,
    Q11.8.2 == "More" ~ 2,
    Q11.8.2 == "No impact" ~ 3,
    Q11.8.2 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.2, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.2, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8.3 Changes in precipitation patterns

#### Entire sample

```{r Q11.8.3, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.3, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.3, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.3 = factor(Q11.8.3)) %>%
  ggplot(aes(Q11.8.3, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.3", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.3) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.3 = factor(Q11.8.3)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.3)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.3") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.3 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.3 to numeric
df %>%
  mutate(Q11.8.3 = case_when(
    Q11.8.3 == "Less" ~ 1,
    Q11.8.3 == "More" ~ 2,
    Q11.8.3 == "No impact" ~ 3,
    Q11.8.3 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.3, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.3) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.3, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8.4 Wildfires

#### Entire sample

```{r Q11.8.4, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.4, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.4, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.4 = factor(Q11.8.4)) %>%
  ggplot(aes(Q11.8.4, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.4", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.4) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.4 = factor(Q11.8.4)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.4)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.4") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.4 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.4 to numeric
df %>%
  mutate(Q11.8.4 = case_when(
    Q11.8.4 == "Less" ~ 1,
    Q11.8.4 == "More" ~ 2,
    Q11.8.4 == "No impact" ~ 3,
    Q11.8.4 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.4, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.4) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.4, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8.5 Changes in temperature

#### Entire sample

```{r Q11.8.5, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.5, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.5, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.5 = factor(Q11.8.5)) %>%
  ggplot(aes(Q11.8.5, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.5", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.5) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.5 = factor(Q11.8.5)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.5)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.5") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.5 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.5 to numeric
df %>%
  mutate(Q11.8.5 = case_when(
    Q11.8.5 == "Less" ~ 1,
    Q11.8.5 == "More" ~ 2,
    Q11.8.5 == "No impact" ~ 3,
    Q11.8.5 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.5, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.5) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.5, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8.6 Famines and food shortages

#### Entire sample

```{r Q11.8.6, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.6, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.6, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.6 = factor(Q11.8.6)) %>%
  ggplot(aes(Q11.8.6, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.6", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.6) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.6 = factor(Q11.8.6)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.6)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.6") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.6 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.6 to numeric
df %>%
  mutate(Q11.8.6 = case_when(
    Q11.8.6 == "Less" ~ 1,
    Q11.8.6 == "More" ~ 2,
    Q11.8.6 == "No impact" ~ 3,
    Q11.8.6 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.6, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.6) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.6, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Q11.8.7 Refugees

#### Entire sample

```{r Q11.8.7, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q11.8.7) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.8.7, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.8.7) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.8.7, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.8.7 = factor(Q11.8.7)) %>%
  ggplot(aes(Q11.8.7, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.8.7", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q11.8.7) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q11.8.7 = factor(Q11.8.7)) %>%
  ggplot(aes(x = "", y = answers, fill = Q11.8.7)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q11.8.7") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q11.8.7 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q11.8.7 to numeric
df %>%
  mutate(Q11.8.7 = case_when(
    Q11.8.7 == "Less" ~ 1,
    Q11.8.7 == "More" ~ 2,
    Q11.8.7 == "No impact" ~ 3,
    Q11.8.7 == "Prefer not to respond" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q11.8.7, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 4)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.8.7) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.8.7, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```


## Q.11.9 If changes in the climate or weather patterns continue to worsen at the same rate that they are changing now, how would this impact your need to migrate?

All the answers are in a **scale of 1-6**, i.e. can have the following values: 1, 2, 3, 4, 5, 6.

Ex:
1 = Significantly Increase
2 = Moderately Increase
3 = Will not Impact
4 = Moderately Decrease
5 = Significantly Decrease
6 = Don't know
  -2. Prefer not to answer

#### Entire sample
```{r Q.11.9, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q.11.9) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q.11.9, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q.11.9) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q.11.9, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q.11.9 = factor(Q.11.9)) %>%
  ggplot(aes(Q.11.9, answers)) +
  geom_col( fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q.11.9", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

#For a Pie chart 

df %>%
  group_by(Q.11.9) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  mutate(percentage = answers / sum(answers) * 100,
         Q.11.9 = factor(Q.11.9)) %>%
  ggplot(aes(x = "", y = answers, fill = Q.11.9)) +
  geom_bar(stat = "identity", width = 1, color = "black") +
  coord_polar("y") +
  labs(x = NULL, y = NULL, fill = "Response",
       title = "Q.11.9") +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        panel.grid = element_blank()) +
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "white", size = 6)
```

#### By county

```{r Q.11.9 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

# Convert Q.11.9 to numeric
df %>%
  mutate(Q.11.9 = case_when(
    Q.11.9 == "Significantly Increase" ~ 1,
    Q.11.9 == "Moderately Increase" ~ 2,
    Q.11.9 == "Will not Impact" ~ 3,
    Q.11.9 == "Moderately Decrease" ~ 4,
    Q.11.9 == "Significantly Decrease" ~ 5,
    Q.11.9 == "Don't know" ~ 6, 
    Q.11.9 == "Prefer not to answer" ~ NA_real_
  )) %>%
  group_by(Q1.5_County) %>%
  summarize(mean_response = mean(Q.11.9, na.rm = TRUE)) %>%
  kable(align = "lc", col.names = c("County", "Mean Response (1 to 5)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q.11.9) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q.11.9, answers, percentage) %>%
  kable(align = "llcc") %>%
  kable_styling(position = "left", full_width = F)
```

## Interpretation on Environmental Fragility

Coming soon...
